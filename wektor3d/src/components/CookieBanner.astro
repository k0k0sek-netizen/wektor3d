<div id="cookie-banner" class="fixed bottom-0 left-0 w-full bg-zinc-950/95 backdrop-blur-md border-t border-zinc-800 p-4 md:p-6 z-[100] translate-y-full transition-transform duration-500 shadow-2xl flex flex-col md:flex-row items-center justify-between gap-4 hidden">
  <div class="text-zinc-300 text-sm max-w-3xl">
    <p>
      ğŸª <strong>SzanujÄ™ TwojÄ… prywatnoÅ›Ä‡.</strong> UÅ¼ywam plikÃ³w cookies (Google Analytics) do analizy ruchu oraz marketingu, aby dopasowaÄ‡ ofertÄ™ do Twoich potrzeb.
      <a href="/polityka-prywatnosci" class="text-orange-500 hover:text-white underline ml-1">Polityka PrywatnoÅ›ci</a>.
    </p>
  </div>
  <div class="flex gap-3 shrink-0">
    <button id="cookie-reject" class="px-4 py-2 border border-zinc-700 text-zinc-400 rounded-lg hover:bg-zinc-800 hover:text-white transition-colors text-sm font-medium">
      Tylko niezbÄ™dne
    </button>
    <button id="cookie-accept" class="px-6 py-2 bg-orange-700 hover:bg-orange-600 text-white rounded-lg transition-colors text-sm font-bold shadow-lg shadow-orange-900/20">
      AkceptujÄ™
    </button>
  </div>
</div>

<script is:inline>
  // Funkcja aktualizujÄ…ca zgody w GTM (Consent Mode)
  function updateConsent(granted) {
    const status = granted ? 'granted' : 'denied';
    
    // Upewnij siÄ™, Å¼e function gtag istnieje (z Layoutu)
    if (typeof gtag === 'function') {
      gtag('consent', 'update', {
        'ad_storage': status,
        'analytics_storage': status
      });
      // Opcjonalnie: reload event jeÅ›li potrzebny
      if (granted) {
        dataLayer.push({'event': 'consent_granted'});
      }
      console.log(`GTM Consent Update: ${status}`);
    }
  }

  // Logika Banera
  const banner = document.getElementById('cookie-banner');
  const acceptBtn = document.getElementById('cookie-accept');
  const rejectBtn = document.getElementById('cookie-reject');
  const storageKey = 'wektor3d_cookie_consent';

  // SprawdÅº decyzjÄ™ (localStorage)
  const consent = localStorage.getItem(storageKey);

  if (!consent) {
    // Brak decyzji -> PokaÅ¼ baner
    banner.classList.remove('hidden');
    setTimeout(() => {
      banner.classList.remove('translate-y-full');
    }, 2000); // Mniejsze opÃ³Åºnienie dla UX
  } else if (consent === 'granted') {
    // Zgoda juÅ¼ byÅ‚a -> Zaktualizuj GTM na start
    updateConsent(true);
  }

  // KlikniÄ™cie Akceptuj
  acceptBtn.addEventListener('click', () => {
    localStorage.setItem(storageKey, 'granted');
    banner.classList.add('translate-y-full');
    setTimeout(() => banner.classList.add('hidden'), 500);
    updateConsent(true);
  });

  // KlikniÄ™cie OdrzuÄ‡
  rejectBtn.addEventListener('click', () => {
    localStorage.setItem(storageKey, 'denied');
    banner.classList.add('translate-y-full');
    setTimeout(() => banner.classList.add('hidden'), 500);
    updateConsent(false);
  });
</script>
