<div id="cookie-banner" class="fixed bottom-0 left-0 w-full bg-zinc-950/95 backdrop-blur-md border-t border-zinc-800 p-4 md:p-6 z-[100] translate-y-full transition-transform duration-500 shadow-2xl flex flex-col md:flex-row items-center justify-between gap-4 hidden">
  <div class="text-zinc-300 text-sm max-w-3xl">
    <p>
       <strong>Szanuj Twoj prywatno.</strong> U偶ywam plik贸w cookies i Google Tag Manager tylko do analizy ruchu, aby ulepsza stron. Nie ledz Ci marketingowo bez Twojej zgody.
      <a href="/polityka-prywatnosci" class="text-orange-500 hover:text-white underline ml-1">Polityka Prywatnoci</a>.
    </p>
  </div>
  <div class="flex gap-3 shrink-0">
    <button id="cookie-reject" class="px-4 py-2 border border-zinc-700 text-zinc-400 rounded-lg hover:bg-zinc-800 hover:text-white transition-colors text-sm font-medium">
      Tylko niezbdne
    </button>
    <button id="cookie-accept" class="px-6 py-2 bg-orange-700 hover:bg-orange-600 text-white rounded-lg transition-colors text-sm font-bold shadow-lg shadow-orange-900/20">
      Akceptuj
    </button>
  </div>
</div>

<script is:inline>
  // Funkcja adujca Tw贸j GTM (GTM-PGC33FGZ)
  function loadGTM() {
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PGC33FGZ'); // Tw贸j ID
    
    console.log('GTM (Analityka) zaadowany po zgodzie.');
  }

  // Logika Banera
  const banner = document.getElementById('cookie-banner');
  const acceptBtn = document.getElementById('cookie-accept');
  const rejectBtn = document.getElementById('cookie-reject');
  const storageKey = 'wektor3d_cookie_consent';

  // Sprawd藕 decyzj (localStorage)
  const consent = localStorage.getItem(storageKey);

  if (!consent) {
    // Brak decyzji -> Poka偶 baner (z maym op贸藕nieniem dla animacji)
    banner.classList.remove('hidden');
    setTimeout(() => {
      banner.classList.remove('translate-y-full');
    }, 1000);
  } else if (consent === 'granted') {
    // Zgoda ju偶 bya -> aduj GTM od razu
    loadGTM();
  }

  // Kliknicie Akceptuj
  acceptBtn.addEventListener('click', () => {
    localStorage.setItem(storageKey, 'granted');
    banner.classList.add('translate-y-full'); // Schowaj
    setTimeout(() => banner.classList.add('hidden'), 500);
    loadGTM(); // Odpal skrypt
  });

  // Kliknicie Odrzu
  rejectBtn.addEventListener('click', () => {
    localStorage.setItem(storageKey, 'denied');
    banner.classList.add('translate-y-full');
    setTimeout(() => banner.classList.add('hidden'), 500);
    // Nie adujemy GTM
  });
</script>
